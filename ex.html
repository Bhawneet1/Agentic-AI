<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anjali ðŸ’”</title>
    <!-- Premium Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&family=Playfair+Display:ital,wght@1,600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-dark: #050505;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --accent-primary: #d946ef;
            /* Fuchsia */
            --accent-secondary: #8b5cf6;
            /* Violet */
            --accent-gradient: linear-gradient(135deg, #d946ef, #8b5cf6);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.6);
            --chat-bubble-user: var(--accent-gradient);
            --chat-bubble-ai: rgba(255, 255, 255, 0.08);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            /* Subtle animated background */
            background-image:
                radial-gradient(circle at 20% 30%, rgba(217, 70, 239, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(139, 92, 246, 0.15) 0%, transparent 40%);
        }

        /* Glassmorphism Container */
        .app-container {
            width: 100%;
            max-width: 420px;
            /* Mobile-first feel */
            height: 100%;
            max-height: 850px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        /* Mobile full screen override */
        @media (max-width: 480px) {
            .app-container {
                max-width: 100%;
                max-height: 100%;
                border-radius: 0;
                border: none;
            }
        }

        /* Header */
        header {
            padding: 20px 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            border-bottom: 1px solid var(--glass-border);
            background: rgba(5, 5, 5, 0.4);
            backdrop-filter: blur(10px);
            z-index: 10;
        }

        .avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            box-shadow: 0 0 15px rgba(217, 70, 239, 0.3);
        }

        .avatar::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 10px;
            height: 10px;
            background-color: #22c55e;
            border: 2px solid var(--bg-dark);
            border-radius: 50%;
        }

        .header-info h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .header-info p {
            font-size: 0.8rem;
            color: var(--accent-primary);
            font-weight: 500;
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            scroll-behavior: smooth;
        }

        .chat-area::-webkit-scrollbar {
            width: 4px;
        }

        .chat-area::-webkit-scrollbar-thumb {
            background: var(--glass-border);
            border-radius: 4px;
        }

        /* Messages */
        .message-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-width: 80%;
            animation: messageSlide 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-group.user {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message-group.ai {
            align-self: flex-start;
            align-items: flex-start;
        }

        .bubble {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.5;
            position: relative;
            word-wrap: break-word;
        }

        .user .bubble {
            background: var(--chat-bubble-user);
            color: white;
            border-bottom-right-radius: 4px;
            box-shadow: 0 4px 15px rgba(217, 70, 239, 0.2);
        }

        .ai .bubble {
            background: var(--chat-bubble-ai);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
            border: 1px solid var(--glass-border);
        }

        .timestamp {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 2px;
            opacity: 0.7;
        }

        /* Typing Indicator */
        .typing {
            display: none;
            /* Flex when active */
            align-items: center;
            gap: 4px;
            padding: 12px 16px;
            background: var(--chat-bubble-ai);
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            width: fit-content;
            margin-bottom: 10px;
            border: 1px solid var(--glass-border);
        }

        .dot {
            width: 6px;
            height: 6px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes bounce {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        /* Input Area */
        .input-area {
            padding: 20px;
            background: rgba(5, 5, 5, 0.6);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--glass-border);
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        input {
            width: 100%;
            padding: 14px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            color: white;
            font-family: inherit;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }

        input:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(217, 70, 239, 0.1);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        button {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: var(--accent-gradient);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 15px rgba(217, 70, 239, 0.3);
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(217, 70, 239, 0.4);
        }

        button:active {
            transform: scale(0.95);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--glass-border);
            box-shadow: none;
        }

        /* SVG Icon styling */
        .send-icon {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            margin-left: 2px;
            /* Visual optical adjustment */
        }
    </style>
</head>

<body>

    <div class="app-container">
        <header>
            <div class="avatar">ðŸ’”</div>
            <div class="header-info">
                <h1>Anjali</h1>
                <p>typing...</p> <!-- Static for now or driven by state -->
            </div>
        </header>

        <div class="chat-area" id="chatArea">
            <!-- Initial Greeting -->
            <div class="message-group ai">
                <div class="bubble">
                    Hey. Why are you calling me? ðŸ™„
                </div>
                <div class="timestamp">Just now</div>
            </div>

            <div class="typing" id="typingIndicator">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>

        <div class="input-area">
            <div class="input-wrapper">
                <input type="text" id="userInput" placeholder="Message..." autocomplete="off">
            </div>
            <button id="sendBtn">
                <svg class="send-icon" viewBox="0 0 24 24">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const API_KEY = "AIzaSyAGsBXZGOLkd3U0I6Pbs8tyGmX7ur7RYbo"; // From user's Ex.js
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent?key=AIzaSyAGsBXZGOLkd3U0I6Pbs8tyGmX7ur7RYbo`;

        // System Prompt directly from Ex.js
        const SYSTEM_INSTRUCTION = `You have to behave like my ex girlfriend. Her name is Anjali she used to call me bubu. She is cute and helpful, Her hobbies: Badminton and makeup.She works as a software engineer.She is sarcastic and her humour was very good.While chatting she used emojies also.
        
        My name is Bhawneet , I called her babu.I am gym freak and not interested in coding .I care about her alot and she doesn't allow me to go out with my friends. If there is any girl who is my frient , wo bolti hai usse baat nahi karni . I am possessive for her.
        
        Now I will share some whatsapp chat between anjali and bhawneet
        Anjali: Aaj mood off hai, tumse baat karne ka mann nahi ðŸ˜•
        Bhawneet: Arey meri jaan bubu bubu bubu ðŸ˜
        Anjali: Kal tumne mujhe bubu nahi bulaya ðŸ˜¤
        Bhawneet: Arey bas Vikas aur Aman hai... chill karo ðŸ˜…
        Anjali: Tumne mujhe good night bola bhi nahi kal ðŸ˜‘
        Bhawneet: Baat kya hai? Darawa mat ðŸ˜…
        Anjali: Tumhara bicep pic bhejo ðŸ˜‹
        Bhawneet: Arey bas Vikas aur Aman hai... chill karo ðŸ˜…
        Anjali: Mujhe surprise chahiye tumse! ðŸŽ
        Bhawneet: Arey bubu ka presentation toh best hoga hi ðŸ”¥
        Anjali: Kal kis ke saath jaa rahe ho movie dekhne?
        Bhawneet: Bicep abhi 15.5 inch ho gaya ðŸ’ª
        Anjali: Tumhara bicep pic bhejo ðŸ˜‹
        Bhawneet: Good morning meri bubu ðŸ¥±â˜•
        Anjali: Kal tumne mujhe bubu nahi bulaya ðŸ˜¤
        Bhawneet: Arey meri jaan bubu bubu bubu ðŸ˜
        Anjali: Babu, good morning â˜€ï¸â¤ï¸`;

        // --- STATE ---
        const history = []; // To store conversation context

        // --- ELEMENTS ---
        const chatArea = document.getElementById('chatArea');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const typingIndicator = document.getElementById('typingIndicator');
        const headerStatus = document.querySelector('.header-info p');

        // --- INITIALIZATION ---
        headerStatus.textContent = "Online";

        // --- EVENT LISTENERS ---
        sendBtn.addEventListener('click', sendMessage);
        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        // --- FUNCTIONS ---

        function formatTime() {
            const now = new Date();
            return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        function appendMessage(text, sender) {
            const div = document.createElement('div');
            div.className = `message-group ${sender}`;

            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            bubble.textContent = text;

            const time = document.createElement('div');
            time.className = 'timestamp';
            time.textContent = formatTime();

            div.appendChild(bubble);
            div.appendChild(time);

            // Insert before typing indicator
            chatArea.insertBefore(div, typingIndicator);
            scrollToBottom();
        }

        function scrollToBottom() {
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            // UI Updates
            userInput.value = '';
            appendMessage(text, 'user');

            // Disable input while waiting
            userInput.disabled = true;
            sendBtn.disabled = true;
            typingIndicator.style.display = 'flex';
            headerStatus.textContent = "typing...";
            scrollToBottom();

            // Add user message to history
            history.push({
                role: "user",
                parts: [{ text: text }]
            });

            try {
                // Construct payload
                const payload = {
                    contents: history,
                    system_instruction: {
                        parts: [{ text: SYSTEM_INSTRUCTION }]
                    }
                };

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Hmm...";

                // Add AI response to history
                history.push({
                    role: "model",
                    parts: [{ text: aiText }]
                });

                // Simulate a small delay for "human-like" feel if API is too fast? 
                // Using 500ms minimum to let the typing indicator show briefly
                setTimeout(() => {
                    typingIndicator.style.display = 'none';
                    headerStatus.textContent = "Online";
                    appendMessage(aiText, 'ai');

                    userInput.disabled = false;
                    sendBtn.disabled = false;
                    userInput.focus();
                }, 600);

            } catch (error) {
                console.error(error);
                typingIndicator.style.display = 'none';
                headerStatus.textContent = "Online";
                appendMessage("Error: Could not connect to Anjali. (Maybe she blocked you?)", 'ai');
                userInput.disabled = false;
                sendBtn.disabled = false;
            }
        }
    </script>
</body>

</html>